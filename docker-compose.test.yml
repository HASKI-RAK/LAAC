# Docker Compose for E2E Testing
# REQ-FN-018: E2E Test Infrastructure
#
# This compose file provides a Redis instance for E2E testing.
# Most E2E tests work without Redis (using in-memory storage),
# but this is useful for testing Redis-specific features.
#
# Usage:
#   docker-compose -f docker-compose.test.yml up -d
#   yarn test:e2e
#   docker-compose -f docker-compose.test.yml down

version: '3.8'

services:
  # Redis instance for E2E tests
  redis-test:
    image: redis:7-alpine
    container_name: laac-redis-test
    ports:
      - "6379:6379"
    command: redis-server --databases 16 --save "" --appendonly no
    # Use database 15 for tests (configured in test/constants.ts)
    # No persistence needed for tests
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 3s
      retries: 5
    networks:
      - laac-test

networks:
  laac-test:
    driver: bridge
